"use strict";(self.webpackChunkseatsAdmin=self.webpackChunkseatsAdmin||[]).push([[685],{9105:(e,n,t)=>{t.d(n,{Z:()=>Te});var r=t(5893),a=t(2635),o=t(3215),i=t(925),s=t(5140),u=t(3264),c=t(154),l=t(5240),f=t(3221),h=t(670),d=t(9704),p=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}u((r=r.apply(e,n||[])).next())}))},v=function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},m=function(){function e(){}return e.prototype.get=function(){return p(this,void 0,Promise,(function(){var e,n,t;return v(this,(function(r){switch(r.label){case 0:return[4,fetch("/aw-api/subscriptions")];case 1:return[4,r.sent().json()];case 2:return e=r.sent(),n=e.totalSeats,t=e.availableSeats,[2,{total:n,available:t}]}}))}))},e.prototype.seats=function(){return p(this,void 0,Promise,(function(){return v(this,(function(e){switch(e.label){case 0:return[4,fetch("/aw-api/users")];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}}))}))},e.prototype.assign=function(){return Promise.resolve()},e.prototype.unAssign=function(){return Promise.resolve()},e}(),y=t(3396),b=t(9826),g=function(){return g=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},g.apply(this,arguments)},w=y.runtime({baseUrl:"/"});function x(e,n,t){return w.ok(w.fetchJson("/v1alpha/orgs/".concat(encodeURIComponent(e),"/licenses/").concat(encodeURIComponent(n)),g({},t)))}function j(e,n,t,r){return w.ok(w.fetchJson("/v1alpha/orgs/".concat(encodeURIComponent(e),"/licenses/").concat(encodeURIComponent(n)),w.json(g(g({},r),{method:"POST",body:t}))))}function C(e,n,t,r){var a=void 0===t?{}:t,o=a.includeUsers,i=a.filter;return w.ok(w.fetchJson("/v1alpha/orgs/".concat(encodeURIComponent(e),"/licenses/").concat(encodeURIComponent(n),"/seats").concat(b.query(b.explode({includeUsers:o,filter:i}))),g({},r)))}var P=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}u((r=r.apply(e,n||[])).next())}))},k=function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},S=function(){function e(e){this.baseUrl=e||""}return e.prototype.get=function(e){var n=e.orgId,t=e.serviceId,r=e.token;return P(this,void 0,Promise,(function(){var e,a;return k(this,(function(o){switch(o.label){case 0:return[4,this.requestHeader(r)];case 1:return e=o.sent(),[4,x(n,t,e)];case 2:return a=o.sent(),[2,{available:Number(a.seatsAvailable)||0,total:Number(a.seatsTotal)||0}]}}))}))},e.prototype.seats=function(e,n){var t,r=e.orgId,a=e.serviceId,o=e.token;return void 0===n&&(n=!0),P(this,void 0,Promise,(function(){var e,i;return k(this,(function(s){switch(s.label){case 0:return[4,this.requestHeader(o)];case 1:return e=s.sent(),[4,C(r,a,{filter:n?"assigned":"assignable"},e)];case 2:return i=s.sent(),[2,(null===(t=i.users)||void 0===t?void 0:t.map((function(e){return{id:e.id||"",firstName:e.firstName||"",lastName:e.lastName||"",userName:e.username||"",assigned:!!e.assigned}})))||[]]}}))}))},e.prototype.requestHeader=function(e){return P(this,void 0,void 0,(function(){return k(this,(function(n){switch(n.label){case 0:return[4,H(e,this.baseUrl)];case 1:return[2,n.sent()]}}))}))},e.prototype.assign=function(e,n){return P(this,void 0,Promise,(function(){var t;return k(this,(function(r){switch(r.label){case 0:return t={assign:n},[4,this.modify(e,t)];case 1:return r.sent(),[2]}}))}))},e.prototype.unAssign=function(e,n){return P(this,void 0,Promise,(function(){var t;return k(this,(function(r){switch(r.label){case 0:return t={unassign:n},[4,this.modify(e,t)];case 1:return r.sent(),[2]}}))}))},e.prototype.modify=function(e,n){var t=e.orgId,r=e.serviceId,a=e.token;return P(this,void 0,Promise,(function(){var e;return k(this,(function(o){switch(o.label){case 0:return[4,this.requestHeader(a)];case 1:return e=o.sent(),[2,j(t,r,n,e)]}}))}))},e}(),O=function(){return O=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},O.apply(this,arguments)},A=y.runtime({baseUrl:"/api/entitlements/v1/"});function U(e,n){var t=void 0===e?{}:e,r=t.limit,a=t.offset;return A.ok(A.fetchJson("/seats".concat(b.query(b.explode({limit:r,offset:a}))),O({},n)))}function N(e,n){return A.ok(A.fetchJson("/seats",A.json(O(O({},n),{method:"POST",body:e}))))}function R(e,n){return A.ok(A.fetchJson("/seats/".concat(encodeURIComponent(e)),O(O({},n),{method:"DELETE"})))}var T=function(){return T=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},T.apply(this,arguments)},E=y.runtime({baseUrl:"/api/rbac/v1"});function I(e,n){var t=void 0===e?{}:e,r=t.limit,a=t.offset,o=t.matchCriteria,i=t.usernames,s=t.sortOrder,u=t.email,c=t.status,l=t.adminOnly,f=t.orderBy,h=t.usernameOnly;return E.ok(E.fetchJson("/principals/".concat(b.query(b.explode({limit:r,offset:a,match_criteria:o,usernames:i,sort_order:s,email:u,status:c,admin_only:l,order_by:f,username_only:h}))),T({},n)))}var q=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}u((r=r.apply(e,n||[])).next())}))},F=function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},B=function(){function e(e){this.baseUrl=e||""}return e.prototype.requestHeader=function(e){return q(this,void 0,void 0,(function(){return F(this,(function(n){switch(n.label){case 0:return[4,H(e.token,this.baseUrl)];case 1:return[2,n.sent()]}}))}))},e.prototype.get=function(e){return q(this,void 0,Promise,(function(){var n,t,r,a,o;return F(this,(function(i){switch(i.label){case 0:return t=U,r=[{limit:10,offset:0}],[4,this.requestHeader(e)];case 1:return[4,t.apply(void 0,r.concat([i.sent()]))];case 2:return n=i.sent(),a=n.allowed||0,o=a-(n.consumed||0),[2,{available:a,total:o}]}}))}))},e.prototype.seats=function(e,n){return void 0===n&&(n=!0),q(this,void 0,Promise,(function(){var t,r;return F(this,(function(a){switch(a.label){case 0:return n?(t=U,r=[{}],[4,this.requestHeader(e)]):[3,3];case 1:return[4,t.apply(void 0,r.concat([a.sent()]))];case 2:return[2,a.sent().data.map((function(e){return{id:e.subscription_id||"",userName:e.account_username||"",firstName:"",lastName:"",assigned:!0}}))];case 3:return[4,this.requestHeader(e)];case 4:return[4,I({usernameOnly:!1},a.sent())];case 5:return[2,a.sent().data.map((function(e){var n=e.username;return{id:n,firstName:e.first_name||"",lastName:e.last_name||"",userName:n,assigned:!1}}))]}}))}))},e.prototype.assign=function(e,n){return q(this,void 0,Promise,(function(){var t=this;return F(this,(function(r){switch(r.label){case 0:return[4,Promise.all(n.map((function(n){return q(t,void 0,void 0,(function(){var t,r;return F(this,(function(a){switch(a.label){case 0:return t=N,r=[{account_username:n}],[4,this.requestHeader(e)];case 1:return[2,t.apply(void 0,r.concat([a.sent()]))]}}))}))})))];case 1:return r.sent(),[2,Promise.resolve()]}}))}))},e.prototype.unAssign=function(e,n){return q(this,void 0,Promise,(function(){var t=this;return F(this,(function(r){switch(r.label){case 0:return[4,Promise.all(n.map((function(n){return q(t,void 0,void 0,(function(){var t,r;return F(this,(function(a){switch(a.label){case 0:return t=R,r=[n],[4,this.requestHeader(e)];case 1:return[2,t.apply(void 0,r.concat([a.sent()]))]}}))}))})))];case 1:return r.sent(),[2,Promise.resolve()]}}))}))},e}(),H=function(e,n){return t=void 0,r=void 0,o=function(){var t;return function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}(this,(function(r){switch(r.label){case 0:return[4,e()];case 1:return t=r.sent(),[2,{headers:{Authorization:"Bearer ".concat(t)},baseUrl:n}]}}))},new((a=Promise)||(a=Promise))((function(e,n){function i(e){try{u(o.next(e))}catch(e){n(e)}}function s(e){try{u(o.throw(e))}catch(e){n(e)}}function u(n){var t;n.done?e(n.value):(t=n.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,s)}u((o=o.apply(t,r||[])).next())}));var t,r,a,o};function L(e,n){switch(e){case"CIAM_Authz":return new S(n);case"entitlements":return new B(n);case"mock":return new m;default:throw new Error("no implementation found for "+e)}}var z=function(){return z=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},z.apply(this,arguments)},_=(0,u.createContext)(void 0),D=function(){return function(e){var n=(0,u.useContext)(e);if(null!=n)return n;throw new Error("No provider found for context, make sure it is included in your component hierarchy.")}(_)},J=function(e){var n=e.serviceName,t=e.baseUrl,a=e.children;return(0,r.jsx)(_.Provider,z({value:L(n,t)},{children:a}))},K=t(3028),M=t(827),V=t(950),G=t(5157),Q=t(9609),Z=t(3047),Y=function(){return Y=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Y.apply(this,arguments)},W=function(){return(0,r.jsx)(c.Icon,Y({status:"danger",size:"xl"},{children:(0,r.jsx)(Z.$O,{})}))},$=function(){return(0,r.jsxs)(c.EmptyState,Y({isFullHeight:!0},{children:[(0,r.jsx)(c.EmptyStateIcon,{component:W,variant:"container"}),(0,r.jsx)(c.Title,Y({headingLevel:"h2",size:"lg"},{children:"Your organization no longer has an Seats Administration subscription."})),(0,r.jsx)(c.EmptyStateBody,{children:"Please contact Red Hat if there is an issue with your subscription or if you wish to continue."})]}))},X=function(){return X=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},X.apply(this,arguments)},ee=function(e){var n=e.usersToRemove,t=e.onOk;return(0,r.jsxs)(c.Modal,X({id:"remove-users-modal",variant:c.ModalVariant.small,isOpen:!0,"aria-label":"Remove users from seats",title:"Remove users from seats",titleIconVariant:"warning",showClose:!1,"aria-describedby":"modal-message",actions:[(0,r.jsx)(c.Button,X({onClick:t,variant:c.ButtonVariant.primary},{children:"Ok"}),1)]},{children:["Your organization has decreased the amount of seats available. Please remove ",n," users from their seats to continue the subscription."]}))},ne=function(){return ne=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},ne.apply(this,arguments)},te=function(e){var n=e.availableSeats,t=e.totalSeats;return(0,r.jsx)(c.PageSection,ne({variant:"light",hasShadowBottom:!0},{children:(0,r.jsxs)(c.TextContent,{children:[(0,r.jsx)(c.Title,ne({headingLevel:"h1"},{children:"Seats Administration"})),(0,r.jsxs)(c.Level,{children:[(0,r.jsx)(c.LevelItem,{children:(0,r.jsx)(c.Text,{children:"This group contains all users assigned seats within your organization."})}),t>0&&(0,r.jsx)(c.LevelItem,{children:(0,r.jsxs)(c.Text,{children:["Seats available: ",(0,r.jsxs)(c.Label,ne({isCompact:!0},{children:[n," of ",t]}))]})})]})]})}))},re=t(227),ae=t(4894),oe=t(7081),ie=function(){return ie=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},ie.apply(this,arguments)},se=function(e){var n=e.totalSeats,t=e.onAddUsers;return(0,r.jsxs)(c.EmptyState,ie({isFullHeight:!0},{children:[(0,r.jsx)(c.EmptyStateIcon,{icon:oe.wl}),(0,r.jsxs)(c.Title,ie({headingLevel:"h2",size:"lg"},{children:["There are currently no users in your organization assigned seats.",(0,r.jsx)("br",{}),"Your organization has ",n," seats available."]})),(0,r.jsx)(c.EmptyStateBody,{children:"Please add users by using the button below."}),(0,r.jsx)(c.Button,ie({ouiaId:"button-create",variant:"primary",onClick:function(){return t()}},{children:"Add users"}))]}))},ue=t(810),ce=function(){return ce=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},ce.apply(this,arguments)},le=function(e){var n=e.onClearAllFilters;return(0,r.jsxs)(c.EmptyState,ce({variant:c.EmptyStateVariant.xs},{children:[(0,r.jsx)(c.EmptyStateIcon,{icon:ue.W1}),(0,r.jsx)(c.Title,ce({headingLevel:"h2",size:"lg"},{children:"No results found"})),(0,r.jsxs)(c.EmptyStateBody,{children:["Adjust your filters and try again, or ",(0,r.jsx)("a",ce({onClick:n},{children:"clear all filters"})),"."]})]}))},fe=function(){return fe=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},fe.apply(this,arguments)},he=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,o=n.length;a<o;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},de=["userName","firstName","lastName"],pe={userName:"Username",firstName:"First name",lastName:"Last name"},ve=function(e){var n=e.users,t=e.itemCount,a=e.page,o=e.perPage,i=e.usernames,s=e.totalSeats,u=e.getUrlForUser,l=e.isColumnSortable,f=e.canAddUser,d=e.isUserChecked,p=e.onCheckUser,v=e.onPageChange,m=e.onRemoveSeat,y=e.onAddUser,b=e.onClearAllFilters,g=i.length>0;return(0,r.jsx)("div",fe({id:"seatTable"},{children:(0,r.jsx)(ae.H,{data:n,columns:de,renderHeader:function(e){var n=e.column,t=e.Th,a=e.key;return(0,r.jsx)(t,{children:pe[n]},a)},renderCell:function(e){var n=e.column,t=e.row,a=e.Td,o=e.key;return(0,r.jsx)(a,fe({dataLabel:pe[n]},{children:"userName"===n?(0,r.jsx)(c.Button,{variant:"link",component:function(e){return(0,r.jsx)(h.Link,fe({to:u(t)},e,{children:t.userName}))},isInline:!0}):t[n]}),o)},renderActions:function(e){var n=e.row;return(0,r.jsx)(re.ActionsColumn,{rowData:me,items:[{title:"Remove seat",onClick:function(){return m(n)}}]})},isColumnSortable:l,toolbarBreakpoint:"lg",actions:he(he([],f?[{label:"Assign user(s)",onClick:y,isPrimary:!0}]:[],!0),[{label:"Remove user(s)",onClick:function(){return m()},isPrimary:!1}],!1),itemCount:t,page:a,perPage:o,onPageChange:v,onClearAllFilters:b,ariaLabel:"Seats Administration users",isFiltered:g,isRowChecked:function(e){var n=e.row;return d(n)},onCheck:function(e,n){var t=e.row;return p(t,n)},emptyStateNoData:(0,r.jsx)(se,{totalSeats:s||0,onAddUsers:y}),emptyStateNoResults:(0,r.jsx)(le,{onClearAllFilters:b})})}))},me={actionProps:{style:{zIndex:9999}}},ye=function(){return ye=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},ye.apply(this,arguments)},be=function(e){var n=e.users,t=e.onConfirm,a=e.onCancel,o=(0,u.useState)(n.slice(0,5)),i=o[0],s=o[1],l=(0,u.useState)(5),f=l[0],h=l[1],d=(0,u.useState)(1),p=d[0],v=d[1];return(0,r.jsxs)(c.Modal,ye({title:"Remove users",titleIconVariant:"warning",isOpen:!0,variant:"small",actions:[(0,r.jsx)(c.Button,ye({variant:"danger",onClick:function(){return t()}},{children:"Remove user(s)"}),"remove"),(0,r.jsx)(c.Button,ye({variant:"link",onClick:function(){return a()}},{children:"Cancel"}),"cancel")],onClose:a},{children:["Are you sure you want to remove the user(s) below from Project Wisdom",n.length>5?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(re.TableComposable,ye({variant:"compact"},{children:[(0,r.jsx)(re.Thead,{children:(0,r.jsx)(re.Tr,{children:(0,r.jsx)(re.Th,{children:"Name"})})}),(0,r.jsx)(re.Tbody,{children:i.map((function(e){return(0,r.jsx)(re.Tr,{children:(0,r.jsxs)(re.Td,ye({dataLabel:"Name"},{children:[e.firstName," ",e.lastName]}))},e.id)}))})]})),(0,r.jsx)(c.Pagination,{isCompact:!0,perPageComponent:"button",itemCount:n.length,perPage:f,page:p,variant:c.PaginationVariant.bottom,perPageOptions:[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20}],onPerPageSelect:function(e,t){h(t),s(n.slice((p-1)*t,p*t))},onSetPage:function(e,t){v(t),s(n.slice((t-1)*f,t*f))}})]}):(0,r.jsx)("p",ye({className:"pf-u-pt-md"},{children:n.map((function(e,t){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("b",{children:[e.firstName," ",e.lastName]}),t!==n.length-1?", ":""]})}))}))]}))},ge=function(){return ge=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},ge.apply(this,arguments)},we=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,o=n.length;a<o;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},xe=function(e){var n,t,a,o,i,s,l,f,d,p,v=e.user,m=e.onSuccess,y=e.onError,b=(0,h.useHistory)(),g=(0,u.useState)([]),w=g[0],x=g[1],j=(0,u.useState)(!1),C=j[0],P=j[1],k=(0,K.J)(),S=k.page,O=k.perPage,A=k.setPagination,U=k.setPaginationQuery,N=(0,u.useCallback)((function(){return U(1,O)}),[O,U]),R=(0,M.R)("username",N),T=D(),E=(0,V.NL)(),I=(0,G.a)({queryKey:["subscriptions"],queryFn:function(){return T.get(v)}}),q=(0,G.a)({queryKey:["users",{page:S,perPage:O,usernames:R.chips}],queryFn:function(){return T.seats(v)}}),F=((null===(n=I.data)||void 0===n?void 0:n.available)||0)<0,B=Math.abs((null===(t=I.data)||void 0===t?void 0:t.available)||0),H=((null===(a=I.data)||void 0===a?void 0:a.total)||0)>0&&0===(null===(o=I.data)||void 0===o?void 0:o.available),L=(0,Q.D)((function(e){return n=void 0,t=void 0,a=function(){return function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}(this,(function(n){switch(n.label){case 0:return[4,T.unAssign(v,e.map((function(e){return e.id})))];case 1:return n.sent(),P(!1),x([]),[2]}}))},new((r=void 0)||(r=Promise))((function(e,o){function i(e){try{u(a.next(e))}catch(e){o(e)}}function s(e){try{u(a.throw(e))}catch(e){o(e)}}function u(n){var t;n.done?e(n.value):(t=n.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}u((a=a.apply(n,t||[])).next())}));var n,t,r,a}),{onSuccess:function(){m&&m("Successfully removed users"),E.invalidateQueries({queryKey:["users"]})},onError:function(e){y&&y("there was an error: "+e)}}).mutate;return(0,r.jsxs)(c.Page,{children:[(0,r.jsx)(te,{totalSeats:(null===(i=I.data)||void 0===i?void 0:i.total)||0,availableSeats:(null===(s=I.data)||void 0===s?void 0:s.available)||0}),0===(null===(l=I.data)||void 0===l?void 0:l.total)&&(0,r.jsx)($,{}),F&&B&&(0,r.jsx)(ee,{usersToRemove:B,onOk:function(){return b.push("/remove-users")}}),C&&(0,r.jsx)(be,{users:w,onConfirm:function(){return L(w)},onCancel:function(){return P(!1)}}),(0,r.jsxs)(c.PageSection,ge({isFilled:!0},{children:[H?(0,r.jsx)(c.Alert,{title:"There are 0 seats left in your organization's subscription. Contact Red Hat to manage your Seats Administration license.",variant:"warning",isInline:!0}):null,0!==(null===(f=I.data)||void 0===f?void 0:f.total)&&(0,r.jsx)(ve,{totalSeats:null===(d=I.data)||void 0===d?void 0:d.total,users:q.data,itemCount:null===(p=q.data)||void 0===p?void 0:p.length,canAddUser:!H,page:S,perPage:O,onPageChange:A,usernames:R.chips,onSearchUsername:R.add,onRemoveUsernameChip:R.remove,onRemoveUsernameChips:R.clear,onClearAllFilters:R.clear,getUrlForUser:function(e){return"#".concat(e.id)},onAddUser:function(){b.push("/add-users")},isUserChecked:function(e){return w.includes(e)},onCheckUser:function(e,n){x(n?we(we([],w,!0),[e],!1):w.filter((function(n){return n!==e})))},onRemoveSeat:function(e){e&&x([e]),P(!0)}})]}))]})},je=function(){return je=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},je.apply(this,arguments)},Ce=function(e){var n=e.users,t=e.itemCount,a=e.page,o=e.perPage,i=e.usernames,s=e.isColumnSortable,u=e.isUserChecked,c=e.onPageChange,l=e.onClearAllFilters,f=e.onCheckUser,h=i.length>0,d=(a-1)*(o||20);return(0,r.jsx)(ae.H,{data:null==n?void 0:n.slice(d,d+(o||20)),columns:de,renderHeader:function(e){var n=e.column,t=e.Th,a=e.key;return(0,r.jsx)(t,{children:pe[n]},a)},renderCell:function(e){var n=e.column,t=e.row,a=e.Td,o=e.key;return(0,r.jsx)(a,je({dataLabel:pe[n]},{children:t[n]}),o)},isColumnSortable:s,isRowChecked:function(e){var n=e.row;return u(n)},onCheck:function(e,n){var t=e.row;return f(t,n)},toolbarBreakpoint:"lg",itemCount:t,page:a,perPage:o,onPageChange:c,onClearAllFilters:l,ariaLabel:"Seats Administration users",isFiltered:h,emptyStateNoData:(0,r.jsx)(r.Fragment,{}),emptyStateNoResults:(0,r.jsx)(le,{onClearAllFilters:l})})},Pe=function(){return Pe=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Pe.apply(this,arguments)},ke=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,o=n.length;a<o;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},Se=function(e){var n,t,a,o,i,s=e.user,l=e.onSuccess,f=e.onError,d=(0,h.useHistory)(),p=D(),v=function(){return d.push("/")},m=(0,G.a)({queryKey:["subscriptions"],queryFn:function(){return p.get(s)}}),y=(0,K.J)(),b=y.page,g=y.perPage,w=y.setPagination,x=y.setPaginationQuery,j=(0,u.useCallback)((function(){return x(1,g)}),[g,x]),C=(0,M.R)("name",j),P=(0,V.NL)(),k=(0,G.a)({queryKey:["availableUsers",{page:b,perPage:g,usernames:C.chips}],queryFn:function(){return p.seats(s,!1)}}),S=(0,Q.D)((function(){return p.assign(s,N)}),{onSuccess:function(){v(),l("Successfully assigned users"),P.invalidateQueries({queryKey:["users","availableUsers","subscriptions"]})},onError:function(e){f("there was an error: "+e)}}),O=S.mutate,A=S.isLoading,U=(0,u.useState)([]),N=U[0],R=U[1],T=((null===(n=m.data)||void 0===n?void 0:n.total)||0)-((null===(t=m.data)||void 0===t?void 0:t.available)||0),E=void 0===(null===(a=m.data)||void 0===a?void 0:a.total)||!(N.length>0)||N.length+T>m.data.total;return(0,r.jsxs)(c.Modal,Pe({isOpen:!0,title:"Assign users",variant:"medium",onClose:v,actions:[(0,r.jsx)(c.Button,Pe({onClick:function(){return O()},isDisabled:E,isLoading:A},{children:"Assign"}),"assign"),(0,r.jsx)(c.Button,Pe({onClick:v,variant:c.ButtonVariant.link},{children:"Cancel"}),"cancel")]},{children:[N.length+T>((null===(o=m.data)||void 0===o?void 0:o.total)||0)&&(0,r.jsx)(c.Alert,{variant:"warning",isInline:!0,title:"Your organization does not have enough Project Wisdom seats for the assignments below"}),(0,r.jsx)(Ce,{users:k.data,itemCount:null===(i=k.data)||void 0===i?void 0:i.length,page:b,perPage:g,onPageChange:w,usernames:C.chips,onSearchUsername:C.add,onRemoveUsernameChip:C.remove,onRemoveUsernameChips:C.clear,onClearAllFilters:C.clear,isUserChecked:function(e){return N.includes(e.id)},onCheckUser:function(e,n){R(n?ke(ke([],N,!0),[e.id],!1):N.filter((function(n){return n!==e.id})))}})]}))},Oe=function(){return Oe=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Oe.apply(this,arguments)},Ae=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,o=n.length;a<o;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},Ue=function(e){var n,t,a,o=e.user,i=e.onSuccess,s=e.onError,l=(0,h.useHistory)(),f=D(),d=(0,G.a)({queryKey:["subscriptions"],queryFn:function(){return f.get(o)}}),p=(0,K.J)(),v=p.page,m=p.perPage,y=p.setPagination,b=p.setPaginationQuery,g=(0,u.useCallback)((function(){return b(1,m)}),[m,b]),w=(0,M.R)("username",g),x=(0,V.NL)(),j=(0,G.a)({queryKey:["assignedUsers",{page:v,perPage:m,usernames:w.chips}],queryFn:function(){return f.seats(o)}}),C=(0,u.useState)([]),P=C[0],k=C[1],S=((null===(n=d.data)||void 0===n?void 0:n.total)||0)-((null===(t=d.data)||void 0===t?void 0:t.available)||0),O=(0,Q.D)((function(){return k([]),f.unAssign(o,P)}),{onSuccess:function(){i("Successfully removed users"),x.invalidateQueries({queryKey:["users","assignedUsers","subscriptions"]})},onError:function(e){s("there was an error: "+e)}}),A=O.mutate,U=O.isLoading,N=function(){return l.push("/")};return(0,r.jsx)(c.Modal,Oe({isOpen:!0,title:"Remove ".concat(S," users from their assigned seats"),variant:"medium",onClose:N,actions:[(0,r.jsx)(c.Button,Oe({onClick:function(){return A()},isDisabled:P.length>S,isLoading:U},{children:"Remove"}),"remove"),(0,r.jsx)(c.Button,Oe({onClick:N,variant:c.ButtonVariant.link,isDisabled:U},{children:"Cancel"}),"cancel")]},{children:(0,r.jsx)(Ce,{users:j.data,itemCount:null===(a=j.data)||void 0===a?void 0:a.length,page:v,perPage:m,onPageChange:y,usernames:w.chips,onSearchUsername:w.add,onRemoveUsernameChip:w.remove,onRemoveUsernameChips:w.clear,onClearAllFilters:w.clear,isUserChecked:function(e){return P.includes(e.id)},onCheckUser:function(e,n){k(n?Ae(Ae([],P,!0),[e.id],!1):P.filter((function(n){return n!==e.id})))}})}))},Ne=function(){return Ne=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Ne.apply(this,arguments)},Re=function(){var e=(0,u.useState)(),n=e[0],t=e[1],a=(0,d.I0)(),i=function(e,n){void 0===n&&(n="success"),a((0,o.wN)({variant:n,title:e}))},p=function(e){return i(e,"danger")},v=(0,s.Z)().auth,m=v.getToken,y=v.getUser;return(0,u.useEffect)((function(){var e,n,r,a;e=void 0,n=void 0,a=function(){var e;return function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}(this,(function(n){switch(n.label){case 0:return[4,y()];case 1:return(e=n.sent())&&t({orgId:e.identity.org_id,serviceId:"smarts",token:m}),[2]}}))},new((r=void 0)||(r=Promise))((function(t,o){function i(e){try{u(a.next(e))}catch(e){o(e)}}function s(e){try{u(a.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}u((a=a.apply(e,n||[])).next())}))}),[]),n?(0,r.jsx)(u.Suspense,Ne({fallback:(0,r.jsx)(c.Bullseye,{children:(0,r.jsx)(c.Spinner,{})})},{children:(0,r.jsx)(J,Ne({serviceName:"CIAM_Authz",baseUrl:"https://ciam-authz-hw-ciam-authz--runtime-ext.apps.ext.spoke.preprod.us-east-1.aws.paas.redhat.com"},{children:(0,r.jsx)(h.BrowserRouter,Ne({basename:(0,l.eb)(window.location.pathname)+"/seats"},{children:(0,r.jsxs)(h.Switch,{children:[(0,r.jsx)(h.Route,Ne({path:"/add-users"},{children:(0,r.jsx)(Se,{user:n,onSuccess:i,onError:p})})),(0,r.jsx)(h.Route,Ne({path:"/remove-users"},{children:(0,r.jsx)(Ue,{user:n,onSuccess:i,onError:p})})),(0,r.jsx)(h.Route,Ne({path:"/"},{children:(0,r.jsx)(xe,{user:n,onSuccess:i,onError:p})})),(0,r.jsx)(h.Route,{children:(0,r.jsx)(f.Z,{})})]})}))}))})):(0,r.jsx)(c.Bullseye,{children:(0,r.jsx)(c.Spinner,{})})};const Te=function(){var e=(0,s.Z)().updateDocumentTitle;return(0,u.useEffect)((function(){(0,i.JH)().register({notifications:o.ee}),e("Seats Administration")}),[]),(0,r.jsxs)(u.Fragment,{children:[(0,r.jsx)(a.ZP,{}),(0,r.jsx)(Re,{})]})}},8161:(e,n,t)=>{t.d(n,{S:()=>u});var r=t(925),a=t(8573),o=t.n(a),i=t(4885),s=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,o=n.length;a<o;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))};function u(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(0,r.JH)({},s([o(),(0,i.ZP)({errorDescriptionKey:["detail","stack"]})],e,!0))}}}]);
//# sourceMappingURL=../sourcemaps/685.3bdb3c84b69714f1f3db5f6d2a04e997.js.map